name: Discord notifier
on:
  pull_request:
    branches:
    - main
    types: [opened, reopened, closed]
  push:
    tags:
      - '**'
jobs:
  Notify-Discord-PR:
    if: github.event_name == 'pull_request'
    runs-on: ubuntu-latest
    steps:
    - name: Notify Discord - Pull Request
      uses: rjstone/discord-webhook-notify@v1
      with:
        severity: info
        webhookUrl: ${{ secrets.DISCORD_WEBHOOK }}
        description: |
          **Pull Request ${{ github.event.action }}**
          ${{ github.event.pull_request.title }}
        details: |
          **Author:** ${{ github.event.pull_request.user.login }}
          **Status:** ${{ github.event.pull_request.state }}
          **Merged:** ${{ github.event.pull_request.merged }}
          **Link:** ${{ github.event.pull_request.html_url }}
        username: Unustasis Bot

  Notify-Discord-Tag:
    if: github.event_name == 'push' && startsWith(github.ref, 'refs/tags/')
    runs-on: ubuntu-latest
    steps:
    - name: Notify Discord - Tag
      uses: rjstone/discord-webhook-notify@v1
      with:
        severity: info
        webhookUrl: ${{ secrets.DISCORD_WEBHOOK }}
        description: |
          **New Tag Created**
          Tag: ${{ github.ref_name }}
        details: |
          **Repository:** ${{ github.repository }}
          **Pushed by:** ${{ github.actor }}
          **Link:** https://github.com/${{ github.repository }}/releases/tag/${{ github.ref_name }}
        username: Unustasis Bot
